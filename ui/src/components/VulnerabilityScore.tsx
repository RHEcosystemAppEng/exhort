import React from 'react';
import {
  Progress,
  ProgressMeasureLocation,
  ProgressSize,
  Split,
  SplitItem,
} from '@patternfly/react-core';
import {Vulnerability} from '../api/report';

interface VulnerabilityScoreProps {
  vulnerability: Vulnerability;
}

export const VulnerabilityScore: React.FC<VulnerabilityScoreProps> = ({ vulnerability }) => {
  const severity = vulnerability.severity;
  let progressBarClassName;
  switch (severity) {
    case 'CRITICAL':
      progressBarClassName = 'bar-critical'
      break;
    case 'HIGH':
      progressBarClassName = 'bar-high'
      break;
    case 'MEDIUM':
      progressBarClassName = 'bar-medium'
      break;
    case 'LOW':
      progressBarClassName = 'bar-low'
      break;
    default:
      progressBarClassName = 'bar-default'
      break;
  }
  return (
    <>
      <Split hasGutter>
        <SplitItem isFilled>
          <Progress
              title={`${vulnerability.cvssScore}/10`}
              aria-label="cvss-score"
              value={vulnerability.cvssScore}
              min={0}
              max={10}
              size={ProgressSize.sm}
              measureLocation={ProgressMeasureLocation.none}
              className={`${progressBarClassName}`}
          />
        </SplitItem>
      </Split>
    </>
  );
};
