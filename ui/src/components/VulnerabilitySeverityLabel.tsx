import React from 'react';
import { Label } from '@patternfly/react-core';
import { Vulnerability } from '../api/report';
import { uppercaseFirstLetter } from '../utils/utils';

interface VulnerabilitySeverityLabelProps {
  vulnerability: Vulnerability;
}

export const VulnerabilitySeverityLabel: React.FC<VulnerabilitySeverityLabelProps> = ({
  vulnerability,
}) => {
  let color: 'blue' | 'cyan' | 'green' | 'orange' | 'purple' | 'red' | 'grey' | 'gold';
  switch (vulnerability.severity) {
    case 'CRITICAL':
    case 'HIGH':
      color = 'red';
      break;
    case 'MEDIUM':
      color = 'orange';
      break;
    case 'LOW':
      color = 'gold';
      break;
    default:
      color = 'grey';
      break;
  }
  return (
    <>
      <Label color={color} isCompact>
        {uppercaseFirstLetter(vulnerability.severity)}
      </Label>
    </>
  );
};
