import React from 'react';
import { Button, ButtonVariant } from '@patternfly/react-core';
import { Vulnerability } from '../api/report';
import { issueLink } from '../utils/utils';

interface VulnerabilityLinkProps {
  providerName: 'snyk' | 'oss-index';
  vunerability: Vulnerability;
}

export const VulnerabilityLink: React.FC<VulnerabilityLinkProps> = ({
  providerName,
  vunerability,
}) => {
  return (
    <>
      <Button
        variant={ButtonVariant.link}
        component="a"
        href={issueLink(providerName, vunerability.id)}
        target="_blank"
        rel="noreferrer"
      >
        {vunerability.id}
      </Button>
    </>
  );
};
